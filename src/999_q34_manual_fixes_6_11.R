
# grades wrong edits

grades_wrong_list <- tribble(
  ~student_id, ~first_last,
  50573164, "D'rel Thomas",
  50306715, "Christian Baily",
  50291074, "Michyah Banks",
  50126220, "Jacobi Blackwell",
  50293469, "Ricaya Carson", 
  50292398, "Anthony Garrett", 
  50190299, "De'John Garrett", 
  50149009, "Kenneth Gayden", 
  50245808, "Nasir Hamilton", 
  50161298 , "James Hil", 
  50341275, "Janae Jackson Walker",
  50302702, "Nadia Johnson", 
  50431283, "Nia Lofton", 
  50191272, "Rashad Mitchell", 
  50203823, "Samyah Nevils", 
  50403120, "Enoye Osabuohien", 
  50238506, "Jala Parish", 
  50249428, "Lidia Perez", 
  50171661, "Nicole Phillips", 
  50218752, "Brianna Reed", 
  50225488, "Dominic Richardson", 
  50193117, "Trinity Robinson", 
  50170991, "Darrialmond Sankey", 
  50287967, "Erik Saunders", 
  50292196, "Zaria Swader", 
  50296720, "Destiny Taylor", 
  50170452, "Jordan Taylor", 
  50229519, "Frances Watkins", 
  50161820, "Glendra Williams", 
  50157310, "K'Juan Williams",
  50225508, "Deondrae Davis",
  50198121, "Jamya Anderson", 
  45622851, "Caleb Anderson", 
  50095483, "Rakai Ashford", 
  50096771, "Antinique Burnside", 
  50123366, "Marayah Cansler", 
  45489957, "Dareon Embry", 
  50122024, "Blessing Felters", 
  50108153, "Malik Flowers", 
  50139147, "Taron Haynes", 
  50492556, "Dominique Hopkins", 
  50175550, "Lamarriah Jackson", 
  50402383, "Mya Lacey", 
  50144397, "Astrid McAfee", 
  50123668, "Shylah Mitchell", 
  50111838, "Mya Moore", 
  50150686, "Elijah Nichols", 
  50150034, "Cortez Phillips", 
  50139937, "Mykael Russell", 
  50225474, "Susie Sanders", 
  50144663, "Alana Savado", 
  50150143, "Latrell Scott", 
  50121444, "Amir Sparks", 
  45150429, "Keywann Timmons", 
  50553086, "Dianne Vidal", 
  50073936, "Terrance Watkins", 
  50144091, "Dae'viera Woods",
  50324406, "Jhulian Carter",
  50623799, "Taimar Curtis",
  50422834, "Armani Johnson",
  50483221, "Dashiya Yancy",
  50402486, "Erickah Anderson",
  50496074, "Jozlyn Anderson",
  50429262, "Maki Brown",
  50576443, "Ryheam Crockett",
  50312224, "Dorian Gossitt",
  50461138, "Deparrish Hozier",
  50318642, "Aden Jones",
  50490125 , "Kelvin McClain",
  50376858, "Isaly Ortiz",
  50407117, "Jaynia Patrick",
  50463526, "Isiah Scott",
  50309702, "Janelle Story",
  50552315, "London Thompson",
  50527586, "Aiden Wright",
  50481249, "Corey Bennet",
  50448707, "Karion Blanks",
  50411967, "Kamareon Collins",
  50412934, "Jashon Stephen",
  50585435, "Demir Thompson",
  50478235, "Nevillia Corethers",
  50356016, "Tairell Ford", 
  50546067, "Demarion Hill",
  50464384, "Clayton Jackson", 
  50550824, "London McDonald",
  50602830, "Frank Scott",
  50415900, "Ashley Weatherall",
  50350012, "Alexiana Lockett",
  50404546, "Anton Bates",
  50306890, "Kamron Hannah",
  50361814, "Daveon Holland",
  50461135, "Chantell Hoyle",
  50388237, "Semaj London",
  50369968, "Anthony Mitchell Jr",
  50533682, "Jayden Pacheco",
  50283836, "Jacob Patterson",
 50075462, "Ihlahy-Shamahd Conley",
 50125880,	"Tateya Gantt",
 50110514,	"Johnny Henderson",
 50150163,	"Na'vaeya Hill",
 50176273,	"Dayvon Holman",
 50043857,	"Tajuan Jones",
 50177535,	"Jayla Love",
 # 50273458, 'Luke Bellamy',
 50262062, 'Treyvon Binion',
 50165115, 'Labrun Bob',
 50254618, 'Eliah Brown',
 50487211, 'Kamora Burnett',
 50488617, 'Kaydance Burnett',
 50291310, 'Corvell Butler',
 60020718, 'Ethan Carey',
 50068673, 'Taniya Chess',
 50288822, 'Brandon Choice',
 50267153, 'Jamarion Coleman',
 50372422, 'McKye Collins',
 50365708, 'Markyce Collins',
 50176277, 'Rayshawn Collins',
 50102637, 'Jahlyn Correa',
 50298689, 'Tayshaun Crew',
 50373669, 'Akni Davis',
 50127375, 'Kemarion Davis',
 50248582, 'Dearris Dukes',
50173921, 'Kindrick Estes',
50286516, 'Adrianna Floyd',
50714432, 'Markell Freeman',
# 50465034, 'Korey Gardner',
50070620, 'Alasia Garrison',
50109855, 'Javar Gates',
50288987, 'Demetrius Gipson',
50307194, 'Karizmah Greer',
50233987, 'Dasayvion Harrell',
50401908, 'Javaris Harris',
50147113, 'Niko Hodges',
50104411, 'Jared Holmes',
#50157318, 'Reginald Horton',
44893967, 'Jeremiah Horton',
50289884, 'Jaylen Ivy',
50236966, 'Perry Johnson',
50219407, 'Yakteodia Kizer',
50190561, 'Jaquavion Kyles',
50373436, 'Tyairy Larry',
50173218, 'Deneal Maxey',
50188774, 'Limija McGee',
50127814, 'Takoera Miles',
50111829, 'Kamarion Milton',
50412715, 'Malik Minor',
50351056, 'Dyaris Newbill',
 50370452, 'Daisha Patterson',
 50370452, 'Daisha Patterson',
 50233877, 'Erick Patterson',
 50371853, 'Dontrell Patterson',
 50233877, 'Erick Patterson',
 50371853, 'Dontrell Patterson',
 50172183, 'Jamarrion Peterson',
 50290963, 'Malek Petty',
 50124975, 'Daywonna Randle',
 50358372, 'Rekayla Reed',
 50238034, 'Demarcus Reynolds',
 # 50207653, 'Mya Shuttlesworth',
 50187248, 'Jairen Simbler',
 # 50171288, 'Danika Smith',
 50310312, 'Treyvion Stenson',
 50117506, 'Donald Swope',
 50352312, 'Troy Taylor',
 50231640, 'Kaliyah Taylor',
 # 32644805, 'Tristan Tuff',
 50269275, 'Darcus Wardlaw',
 50229395, 'Erionna Williams',
 50229721, 'Shania Williams-Brown',
 50334413, 'Jamariah Wilson',
 50293604, 'Tikeyan Wooten'
)


final_grades_edits <- final_percents %>%
  filter(student_id %in% grades_wrong_list$student_id) %>%
  mutate(percent = as.character(round(percent, 0))) %>%
  left_join(grade_percent_scale %>% 
              mutate(percent = as.character(percent)),
            by = "percent") %>%
 select(-percent) 


final_percent_grades_edits <- final_percents %>% 
  filter(student_id %in% grades_wrong_list$student_id) %>%
  mutate(percent = as.character(round(percent, 0))) %>%
  left_join(grade_percent_scale %>% 
              mutate(percent = as.character(percent)),
            by = "percent") %>%
  unique() %>%
  group_by(student_id) %>%
  pivot_wider(names_from = subject, values_from = c(percent, grade)) %>%
  janitor::clean_names() 

quarter_gpa_edit <- quarter_grades %>%
  filter(student_id %in% grades_wrong_list$student_id) %>%
  mutate(grade = case_when(
    percent == "90%" ~ "A-",
    percent == "80%" ~ "B-",
    percent == "70%" ~ "C-",
    percent == "60%" ~ "D-",     # bandaid fix, figure out why
    TRUE ~ grade
  )) %>%
  # filter(site_id == ps_schoolid) %>%
  select(site_id, student_id, grade, subject) %>%
  left_join(grade_scale, by = "grade") %>%
  group_by(site_id, student_id) %>%
  summarize(quarter_gpa = round2(mean(points, na.rm = TRUE), digits = 2))

cumulative_gpa_edit <- final_grades_edits %>%
  left_join(grade_scale, by = "grade") %>%
  group_by(site_id, student_id) %>%
  summarize(cumulative_gpa = round2(mean(points, na.rm = TRUE), digits = 2)) 

final_grades_gpa_illuminate_upload_edit <- final_percent_grades_edits %>%
  left_join(quarter_gpa_edit, by = "student_id") %>%
  left_join(cumulative_gpa_edit, by = "student_id")



quarter_grades_edit <- quarter_grades %>% filter(site_id == 400163 & grade_level %in% c(7,8)) %>%
  mutate(subject = case_when(
    subject == "algebra" ~ "math",
    TRUE ~ subject
  )) %>%
  unique() %>%
  mutate(points = case_when(
    str_detect(grade, "A") ~ 4,
    str_detect(grade, "B") ~ 3,
    str_detect(grade, "C") ~ 2,
    str_detect(grade, "D") ~ 1,
    str_detect(grade, "F") ~ 0,
    TRUE ~ 77777777
  )) %>%
  select(student_id,
         subject,
         grade,
         points,
         percent,
         grade_level,
         first_name,
         last_name)

quarter_gpas_edit <- quarter_grades_edit %>%
  group_by(student_id, grade_level, first_name, last_name) %>%
  summarize(quarter_gpa = mean(points))

View(quarter_gpas_edit)

students_to_fix <- read_csv(file = "~/Downloads/report_card_gpa_fix.csv") %>%
  clean_names() %>%
  select(student_id)

fixed_q_gpas <- students_to_fix %>% 
  left_join(quarter_gpas_edit, by = "student_id")

write_csv(fixed_q_gpas, "~/Downloads/kbcp_q_gpa_fix.csv")

